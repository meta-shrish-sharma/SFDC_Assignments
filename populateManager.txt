trigger PopulateManager on Loan__c (before insert) 
{
    List<String> citysInserted = new List<String>();
    for( Loan__c insLoans: trigger.new) //Select only those citys which are inserted just now
    {
        citysInserted.add(insLoans.City__c);
    }
    Map<String, String> cityManagerMap = new Map<String, String>();
    for (Citymanager__c ctyManager : [SELECT Name, User__r.Name FROM Citymanager__c WHERE Name IN :citysInserted])
    {
        cityManagerMap.put(ctyManager.Name, ctyManager.User__r.Name);
    }
    for( Loan__c insLoans: trigger.new)
    {
        if(insLoans.Manager__c == null)
        {
            insLoans.Manager__c = cityManagerMap.get(insLoans.City__c);
        }
    }
}
