public class OpportunityTriggerHandler 
{
    public static void updateOpportunityList(List<Opportunity> oppList, Map<Id, Opportunity> oldOpportunities)
    {
        String lostValue = 'Closed Lost';
        String wonValue = 'Closed Won';
        List<Id> cntId = new List<Id>();
        for (Opportunity opp: oppList)
        {
            cntId.add(opp.BillToContact__c);
        }
        Map<Id, Contact> idCntMap = new Map<Id, Contact>([SELECT Accountid FROM Contact WHERE Id IN :cntId]);
        for(Opportunity opp: oppList)
        {
            if(opp.Manager__c == null && opp.BillToContact__c != null && idCntMap.get(opp.BillToContact__c) != null)
            {
                opp.Manager__c = idCntMap.get(opp.BillToContact__c).Accountid;
            }
            if(opp.StageName == wonValue || opp.StageName == lostValue)
            {
                if(oldOpportunities.get(opp.Id).StageName != null)
                {
                    String oldOpp = oldOpportunities.get(opp.Id).StageName;
                    if(oldOpp != wonValue && oldOpp != lostValue)
                    {
                        opp.CloseDate = System.today();
                    }
                }
                else
                {
                    opp.CloseDate = System.today();
                    //If opportunity stage changes to close from null
                }
            }
        }
    } 
}
